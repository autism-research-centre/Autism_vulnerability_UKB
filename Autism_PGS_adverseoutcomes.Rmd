---
title: "Autism_PGS_vulnerability"
author: "Varun_Warrier"
date: "08/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

Read the file and the required packages

```{r load data and required packages}

library(data.table)
library(dplyr)
library(plyr)
library(ggplot2)
library(BaylorEdPsych)
library(grid)
library(gridExtra)
library(mediation)

load("~/UKB_v2/autismpgsanxietydataset.RData")

merged = merged3
rm(merged3)
```

Generate the variables

```{r create phenotypes and variables}
merged$f.20487.0.0[merged$f.20487.0.0<0]<- NA #Felt hated by family member as a child
merged$f.20488.0.0[merged$f.20488.0.0<0]<- NA #Physically abused by family as a child
merged$f.20491.0.0[merged$f.20491.0.0<0]<- NA #Someone to take to doctor when needed as a child
merged$f.20490.0.0[merged$f.20490.0.0<0]<- NA #Sexually molested as a child
merged$f.20489.0.0[merged$f.20489.0.0<0]<- NA # Felt loved as a child 

merged$f.20485.0.0[merged$f.20485.0.0<0]<- NA #ever contemplated self-harm
merged$f.20479.0.0[merged$f.20479.0.0<0]<- NA #life not worth living
merged$f.20480.0.0[merged$f.20480.0.0<0]<- NA #attempted self-harm
merged$f.20513.0.0[merged$f.20513.0.0<0]<- NA #Recent thoughts of suicide or self-harm
merged$f.2090.0.0[merged$f.2090.0.0<0]<- NA #Seen a gp for nerves etc

#Mediators - protective factors

#Create srs satisfaction scale
merged$family = merged$f.4559.0.0
merged$family[is.na(merged$family)] <- merged$f.4559.1.0
merged$family[is.na(merged$family)] <- merged$f.4559.2.0

merged$friendship = merged$f.4570.0.0
merged$friendship[is.na(merged$friendship)] <- merged$f.4570.1.0
merged$friendship[is.na(merged$friendship)] <- merged$f.4570.2.0

merged$friendship[merged$friendship<0]<- NA #Friendship satsifaction
merged$family[merged$family<0]<- NA #family satisfaction

merged$f.20522.0.0[merged$f.20522.0.0<0]<- NA #Been in a confiding relationship as an adult
merged$f.4537.0.0[merged$f.4537.0.0<0]<- NA #Job satisfaction
merged$f.4537.0.0[merged$f.4537.0.0>6]<- NA #Job satisfaction, not currently employed

merged$socfreq = merged$f.1031.0.0
merged$socfreq[is.na(merged$socfreq)] <- merged$f.1031.1.0
merged$socfreq[is.na(merged$socfreq)] <- merged$f.1031.2.0

merged$socfreq[merged$socfreq<0]<- NA #freqnegcoded


# Mediators - risk factors
#Anxiety 
merged$f.20540.0.0[merged$f.20540.0.0<0]<- NA # multiple worries
merged$f.20541.0.0[merged$f.20541.0.0<0]<- NA # difficulty stopping worrying
merged$f.20429.0.0[merged$f.20429.0.0<0]<- NA # easily tired
merged$f.20427.0.0[merged$f.20427.0.0<0]<- NA # difficulty falling asleep
merged$f.20423.0.0[merged$f.20423.0.0<0]<- NA # edginess
merged$f.20422.0.0[merged$f.20422.0.0<0]<- NA # irritability
merged$f.20419.0.0[merged$f.20419.0.0<0]<- NA # trouble concentrating

merged$anxietyscore = merged$f.20540.0.0 + merged$f.20541.0.0 + merged$f.20429.0.0 + merged$f.20427.0.0 + merged$f.20423.0.0 + merged$f.20422.0.0 + merged$f.20419.0.0


#Depression
merged$f.20446.0.0[merged$f.20446.0.0<0]<- NA # Prolonged feelings of sadness
merged$f.20441.0.0[merged$f.20441.0.0<0]<- NA # loss of interest
merged$f.20449.0.0[merged$f.20449.0.0<0]<- NA # Fatigue or tiredness
merged$f.20450.0.0[merged$f.20450.0.0<0]<- NA # worthlessness
merged$f.20435.0.0[merged$f.20435.0.0<0]<- NA # Difficulty concentrating
merged$f.20532.0.0[merged$f.20532.0.0<0]<- NA # Sleep change
merged$f.20437.0.0[merged$f.20437.0.0<0]<- NA # thoughts of death
merged$f.20536.0.0[merged$f.20536.0.0<0]<- NA # weight change
merged$f.20536.0.0 = ifelse(merged$f.20536.0.0>0, 1, merged$f.20536.0.0) # weight change, recode it to binary

merged$depressionscore = merged$f.20446.0.0 + merged$f.20441.0.0 + merged$f.20449.0.0 + merged$f.20450.0.0 + merged$f.20435.0.0 + merged$f.20532.0.0 + merged$f.20437.0.0 + merged$f.20536.0.0

## Childhood traumasum:
#Negative coding:
merged$f.20489.0.0 <- 4 - merged$f.20489.0.0   # Felt loved as a child 
merged$f.20491.0.0 <- 4 - merged$f.20491.0.0  # Someone to take me to the doctor as a child

merged$childtraumasum = merged$f.20489.0.0 + merged$f.20490.0.0 + merged$f.20488.0.0 + merged$f.20487.0.0 + merged$f.20491.0.0


##Adult self-harm behaviour

#Rescale recent thoughts of suicide or self-harm:

merged$recentsuicideselfharm = ifelse(merged$f.20513.0.0 == 1, 0, merged$f.20513.0.0)
merged$recentsuicideselfharm = ifelse(merged$f.20513.0.0 == 2, 1, merged$recentsuicideselfharm)
merged$recentsuicideselfharm = ifelse(merged$f.20513.0.0 == 3, 2, merged$recentsuicideselfharm)
merged$recentsuicideselfharm = ifelse(merged$f.20513.0.0 == 4, 3, merged$recentsuicideselfharm)

#Create ideation scale
merged$selfharmideation = merged$recentsuicideselfharm + merged$f.20479.0.0 + merged$f.20485.0.0

#Binarize variables

merged$lifenotworthliving = ifelse(merged$f.20479.0.0 ==2, 1 ,merged$f.20479.0.0 )
merged$contemplateselfharm = ifelse(merged$f.20485.0.0 ==2, 1 ,merged$f.20485.0.0 )
merged$recentsuicideselfharm2 = ifelse(merged$recentsuicideselfharm > 1, 1, merged$recentsuicideselfharm)

merged$selfharmscore = merged$lifenotworthliving + merged$contemplateselfharm + merged$f.20480.0.0 + merged$recentsuicideselfharm2


```


## Scale all variables and change some of them to characters

```{r scale variables}

merged$`1.000000` = scale(merged$`1.000000`)
merged$`0.750000` = scale(merged$`0.750000`)
merged$`0.500000` = scale(merged$`0.500000`)
merged$`0.250000` = scale(merged$`0.250000`)
merged$`0.100000` = scale(merged$`0.100000`)
merged$`0.010000` = scale(merged$`0.010000`)
merged$`0.001000` = scale(merged$`0.001000`)

merged$f.22009.0.1 = scale(merged$f.22009.0.1)
merged$f.22009.0.2 = scale(merged$f.22009.0.2)
merged$f.22009.0.3 = scale(merged$f.22009.0.3)
merged$f.22009.0.4 = scale(merged$f.22009.0.4)
merged$f.22009.0.5 = scale(merged$f.22009.0.5)
merged$f.22009.0.6 = scale(merged$f.22009.0.6)
merged$f.22009.0.7 = scale(merged$f.22009.0.7)
merged$f.22009.0.8 = scale(merged$f.22009.0.8)
merged$f.22009.0.9 = scale(merged$f.22009.0.9)
merged$f.22009.0.10 = scale(merged$f.22009.0.10)
merged$f.22009.0.11 = scale(merged$f.22009.0.11)
merged$f.22009.0.12 = scale(merged$f.22009.0.12)
merged$f.22009.0.13 = scale(merged$f.22009.0.13)
merged$f.22009.0.14 = scale(merged$f.22009.0.14)
merged$f.22009.0.15 = scale(merged$f.22009.0.15)
merged$f.22009.0.16 = scale(merged$f.22009.0.16)
merged$f.22009.0.17 = scale(merged$f.22009.0.17)
merged$f.22009.0.18 = scale(merged$f.22009.0.18)
merged$f.22009.0.19 = scale(merged$f.22009.0.19)
merged$f.22009.0.20 = scale(merged$f.22009.0.20)


merged$f.22001.0.0 = as.character(merged$f.22001.0.0) 
merged$f.22000.0.0 = as.character(merged$f.22000.0.0)


#Scaling phenotypes and mediators
## child truama and items
merged$childtraumasum = scale(merged$childtraumasum)
merged$f.20489.0.0 = scale(merged$f.20489.0.0)
merged$f.20490.0.0 = scale(merged$f.20490.0.0)
merged$f.20488.0.0 = scale(merged$f.20488.0.0)
merged$f.20487.0.0 = scale(merged$f.20487.0.0)
merged$f.20491.0.0 = scale(merged$f.20491.0.0)

## Adult SSBI and items
merged$f.20479.0.0 = scale(merged$f.20479.0.0)
merged$lifenotworthliving = scale(merged$lifenotworthliving)
merged$f.20485.0.0 = scale(merged$f.20485.0.0)
merged$contemplateselfharm = scale(merged$contemplateselfharm)
merged$recentsuicideselfharm = scale(merged$recentsuicideselfharm)
merged$recentsuicideselfharm2 = scale(merged$recentsuicideselfharm2)
merged$f.20480.0.0 = scale(merged$f.20480.0.0)
merged$selfharmscore = scale(merged$selfharmscore)
merged$selfharmideation = scale(merged$selfharmideation)

##scale mediating variables
merged$friendship = scale(merged$friendship)
merged$family = scale(merged$family)
merged$socfreq = scale(merged$socfreq)
merged$f.4537.0.0 = scale(merged$f.4537.0.0) #job satisfaction
merged$f.20522.0.0 = scale(merged$f.20522.0.0) #confiding relationship

merged$anxietyscore = scale(merged$anxietyscore)
merged$depressionscore = scale(merged$depressionscore)


```



\newpage

First, let's run the regression models for the child trauma
```{r regression mmodels for child trauma}

## Childhood trauma scores


#model with only covariates
summary(lm(childtraumasum ~ f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
             f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0+ f.22000.0.0, data = merged))


#full model
summary(lm(childtraumasum ~  `1.000000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(childtraumasum ~  `0.750000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


#full model
summary(lm(childtraumasum ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(childtraumasum ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(childtraumasum ~  `0.100000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(childtraumasum ~  `0.010000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(childtraumasum ~  `0.001000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


```

\newpage

Next, let's run the regression models for the selfharmideation
```{R regression for selfharm ideation}

## Selfharmideation

#model with only covariates
summary(lm(selfharmideation ~ f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
             f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0+ f.22000.0.0, data = merged))


#full model
summary(lm(selfharmideation ~  `1.000000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmideation ~  `0.750000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


#full model
summary(lm(selfharmideation ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmideation ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmideation ~  `0.100000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmideation ~  `0.010000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmideation ~  `0.001000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))




```


\newpage

Next, let's run the regression models for the selfharmscores

```{R regression for selfharm scores}
# Self harm score

#model with only covariates
summary(lm(selfharmscore ~ f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
             f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0+ f.22000.0.0, data = merged))


#full model
summary(lm(selfharmscore ~  `1.000000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmscore ~  `0.750000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


#full model
summary(lm(selfharmscore ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmscore ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmscore ~  `0.100000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmscore ~  `0.010000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

#full model
summary(lm(selfharmscore ~  `0.001000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

```

\newpage

Let's now run regression models for individual items in childhood traumatic events

```{R regression for individual childhood traumatic events}
## individual trauma score: f.20489.0.0 <-  # Felt loved as a child

# full model

summary(lm( f.20489.0.0 ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
             f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

# covariates only

summary(lm( f.20489.0.0 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


## individual trauma score: f.20488.0.0 <-#physically abused

# Full model
summary(lm( f.20488.0.0 ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

# Covariates only

summary(lm( f.20488.0.0 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


## individual trauma score: f.20490.0.0 <-# sexually molested

summary(lm( f.20490.0.0 ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

summary(lm( f.20490.0.0 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


## individual trauma score: f.20487.0.0 <-# felt hated

summary(lm( f.20487.0.0 ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

summary(lm( f.20487.0.0 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))


## individual trauma score: f.20491.0.0 <-# taken to the doctor

summary(lm( f.20491.0.0 ~  `0.250000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

summary(lm( f.20491.0.0 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged))

```



\newpage

## PGS of self-harm items
```{R regression for individual selfharm items}
###PGS on self-harm items

## Life not worth living: f.20479.0.0 <-# Life not worth living


a = glm( lifenotworthliving ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(a)
PseudoR2(a)

b = glm( lifenotworthliving ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
              f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
              f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
              f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(b)
PseudoR2(b)

cat("\n")

## Contemplate self harm: f.20485.0.0 <-# contemplated self-harm


a = glm(contemplateselfharm ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
           f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
           f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
           f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(a)
PseudoR2(a)

b = glm( contemplateselfharm ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
           f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
           f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
           f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(b)
PseudoR2(b)

cat("\n")

## Attempt self-harm: f.20480.0.0 <-# attemptselfharm

a = glm(f.20480.0.0 ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
          f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
          f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
          f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(a)
PseudoR2(a)

b = glm(f.20480.0.0 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
           f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
           f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
           f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(b)
PseudoR2(b)

cat("\n")

## recent self-harm: recentsuicideselfharm2
a = glm(recentsuicideselfharm2 ~  `0.500000` + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
          f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
          f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
          f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(a)
PseudoR2(a)

b = glm(recentsuicideselfharm2 ~   f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 +
          f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
          f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
          f.22009.0.19 + f.22009.0.20 + f.22001.0.0 + f.34.0.0 + f.22000.0.0, data = merged)

summary(b)
PseudoR2(b)


```


\newpage

## Moderating effect of sex on child and adult adverse events
```{R moderating effect of sex on SSBI}

summary(lm(childtraumasum ~  `0.250000`*f.22001.0.0 + + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 + f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0, data = merged))


cat("\n")

summary(lm(selfharmideation ~  `0.500000`*f.22001.0.0 + + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0, data = merged))
cat("\n")

summary(lm(selfharmscore ~  `0.500000`*f.22001.0.0 + + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 +
             f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
             f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 , data = merged))


```

\newpage

## Moderating effect of childtrauma on SSBI

```{R moderating effect of trauma on SSBI}
summary(lm(selfharmideation ~  `0.500000`*childtraumasum + f.22001.0.0 + + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 + f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0, data = merged))

cat("\n")

summary(lm(selfharmscore ~  `0.500000`*childtraumasum + f.22001.0.0 + + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 + f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0, data = merged))



```

\newpage

## Lets check if mediating variables are associated with SSBI
```{R regression with outcomes}

setnames( merged, "0.500000", "pgsfive" )

# anxietyscore
summary(lm(selfharmideation ~  anxietyscore + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

#depressionscore
summary(lm(selfharmideation ~  depressionscore + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

# friendship satisfaction
summary(lm(selfharmideation ~  friendship + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

# family satisfaction
summary(lm(selfharmideation ~  family + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

# jobsatisfaction
summary(lm(selfharmideation ~  f.4537.0.0 + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

#socfreq
summary(lm(selfharmideation ~  socfreq + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


# confiding
summary(lm(selfharmideation ~  f.20522.0.0 + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


## Selfharmscore

# anxietyscore
summary(lm(selfharmscore ~  anxietyscore + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

#depressionscore
summary(lm(selfharmscore ~  depressionscore + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

# friendship satisfaction
summary(lm(selfharmscore ~  friendship + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

# family satisfaction
summary(lm(selfharmscore ~  family + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

# jobsatisfaction
summary(lm(selfharmscore ~  f.4537.0.0 + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

#socfreq
summary(lm(selfharmscore ~  socfreq + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


# confiding
summary(lm(selfharmscore ~  f.20522.0.0 + pgsfive + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


```


\newpage

## effect of PGS on mediating variable
```{R pgs on mediating variable}


summary(lm(anxietyscore ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


summary(lm(depressionscore ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


summary(lm(friendship ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

summary(lm(family ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

summary(lm(socfreq ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

summary(lm( f.4537.0.0 ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))

summary(lm( f.20522.0.0 ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged))


```








\newpage

## Mediation effect of depression on SSBI

```{R mediating effect of depression}

merged2 = merged[!is.na(merged$selfharmideation),]
merged2 = merged2[!is.na(merged2$depressionscore),]


outfit = lm(selfharmideation ~  pgsfive + depressionscore + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(depressionscore ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmmediationdepression = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "depressionscore", sims = 1000)


summary(selfharmmediationdepression)

cat("\n")

merged2 = merged[!is.na(merged$selfharmscore),]
merged2 = merged2[!is.na(merged2$depressionscore),]

outfit = lm(selfharmscore ~  pgsfive + depressionscore + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(depressionscore ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmscoredepression = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "depressionscore", sims = 1000)

summary(selfharmscoredepression)

```



## Mediation effect of social (friendship and family) on SSBI

```{R mediating effect of family and friendship}

merged2 = merged[!is.na(merged$selfharmideation),]
merged2 = merged2[!is.na(merged2$family),]


outfit = lm(selfharmideation ~  pgsfive + family + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(family ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmmediationfamily = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "family", sims = 1000)


summary(selfharmmediationfamily)

cat("\n")

merged2 = merged[!is.na(merged$selfharmscore),]
merged2 = merged2[!is.na(merged2$family),]

outfit = lm(selfharmscore ~  pgsfive + family + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(family ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmscorefamily = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "family", sims = 1000)

summary(selfharmscorefamily)

cat("\n")

merged2 = merged[!is.na(merged$selfharmideation),]
merged2 = merged2[!is.na(merged2$friendship),]



outfit = lm(selfharmideation ~  pgsfive + friendship + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(friendship ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmmediationfriendship = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "friendship", sims = 1000)


summary(selfharmmediationfriendship)

cat("\n")

merged2 = merged[!is.na(merged$selfharmscore),]
merged2 = merged2[!is.na(merged2$friendship),]

outfit = lm(selfharmscore ~  pgsfive + friendship + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(friendship ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmscorefriendship = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "friendship", sims = 1000)

summary(selfharmscorefriendship)
```

\newpage

## Mediation effect of socfreq on SSBI

```{R mediating effect of social frequency}

merged2 = merged[!is.na(merged$selfharmideation),]
merged2 = merged2[!is.na(merged2$socfreq),]


outfit = lm(selfharmideation ~  pgsfive + socfreq + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(socfreq ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmmediationsocfreq= mediate(mediatefit, outfit, treat = "pgsfive", mediator = "socfreq", sims = 1000)


summary(selfharmmediationsocfreq)

cat("\n")

merged2 = merged[!is.na(merged$selfharmscore),]
merged2 = merged2[!is.na(merged2$socfreq),]

outfit = lm(selfharmscore ~  pgsfive + socfreq + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

mediatefit = lm(socfreq ~  pgsfive  + f.22009.0.1 + f.22009.0.2 + f.22009.0.3 + f.22009.0.5 + f.22009.0.6 + f.22009.0.7 + f.22009.0.8 + f.22009.0.9 + f.22009.0.10 + f.22009.0.11 + f.22009.0.12 + f.22009.0.13 + f.22009.0.14 + f.22009.0.15 + f.22009.0.16 + f.22009.0.17 + f.22009.0.18 +
f.22009.0.19 + f.22009.0.20 +  f.34.0.0 + f.22000.0.0 + f.22001.0.0, data = merged2)

selfharmscoresocfreq = mediate(mediatefit, outfit, treat = "pgsfive", mediator = "socfreq", sims = 1000)

summary(selfharmscoresocfreq)

```




\newpage

Let's look at centile effects

```{R creating centiles}
merged$percentile25 = ntile(merged$`0.250000`, 100)
merged$percentile50 = ntile(merged$pgsfive, 100)

```


\newpage

## Average scores for childhood traumatic experiences by percentile

```{r average percentile scores}

childtraumasumaverage <- ddply(merged, "percentile25", summarise,
               N    = sum(!is.na(childtraumasum)),
               mean = mean(childtraumasum, na.rm = TRUE),
               sd   = sd(childtraumasum, na.rm = TRUE),
               se   = sd / sqrt(N)
)


felthatedaverage <- ddply(merged, "percentile25", summarise,
               N    = sum(!is.na(f.20487.0.0)),
               mean = mean(f.20487.0.0, na.rm = TRUE),
               sd   = sd(f.20487.0.0, na.rm = TRUE),
               se   = sd / sqrt(N)
)

feltlovedaverage <- ddply(merged, "percentile25", summarise,
               N    = sum(!is.na(f.20489.0.0)),
               mean = mean(f.20489.0.0, na.rm = TRUE),
               sd   = sd(f.20489.0.0, na.rm = TRUE),
               se   = sd / sqrt(N)
)

physicalabuseaverage <- ddply(merged, "percentile25", summarise,
               N    = sum(!is.na(f.20488.0.0)),
               mean = mean(f.20488.0.0, na.rm = TRUE),
               sd   = sd(f.20488.0.0, na.rm = TRUE),
               se   = sd / sqrt(N)
)


childtraumasumaverage

cat("\n")

felthatedaverage

cat("\n")

feltlovedaverage

cat("\n")

physicalabuseaverage

```


\newpage


## Average scores for adult self-harm experiences by percentile

```{R average SSBI scores by percentile}

selfharmscoreaverage <- ddply(merged, "percentile50", summarise,
               N    = sum(!is.na(selfharmscore)),
               mean = mean(selfharmscore, na.rm = TRUE),
               sd   = sd(selfharmscore, na.rm = TRUE),
               se   = sd / sqrt(N)
)


selfharmideationaverage <- ddply(merged, "percentile50", summarise,
               N    = sum(!is.na(selfharmideation)),
               mean = mean(selfharmideation, na.rm = TRUE),
               sd   = sd(selfharmideation, na.rm = TRUE),
               se   = sd / sqrt(N)
)

lifenotworthlivingaverage <- ddply(merged, "percentile50", summarise,
               N    = sum(!is.na(lifenotworthliving)),
               mean = mean(lifenotworthliving, na.rm = TRUE),
               sd   = sd(lifenotworthliving, na.rm = TRUE),
               se   = sd / sqrt(N)
)

contemplateselfharmaverage <- ddply(merged, "percentile50", summarise,
               N    = sum(!is.na(contemplateselfharm)),
               mean = mean(contemplateselfharm, na.rm = TRUE),
               sd   = sd(contemplateselfharm, na.rm = TRUE),
               se   = sd / sqrt(N)
)


attemptselfharmaverage <- ddply(merged, "percentile50", summarise,
               N    = sum(!is.na(f.20480.0.0)),
               mean = mean(f.20480.0.0, na.rm = TRUE),
               sd   = sd(f.20480.0.0, na.rm = TRUE),
               se   = sd / sqrt(N)
)

cat("\n")

selfharmscoreaverage

cat("\n")

selfharmideationaverage

cat("\n")

lifenotworthlivingaverage

cat("\n")

contemplateselfharmaverage

cat("\n")

attemptselfharmaverage

```


\newpage

## Plots based on percentile for each score item
```{R create plots}

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

childtraumaplot = ggplot(na.omit(childtraumasumaverage), aes(x=percentile25, y=mean)) + geom_point(aes(col = percentile25))  + xlab ("Percentile of polygenic scores") + ylab ("Mean childhood trauma score") + theme_classic()+ guides(colour = FALSE) + ggtitle("Childhood trauma score")

selfharmscoreplot = ggplot(na.omit(selfharmscoreaverage), aes(x=percentile50, y=mean)) + geom_point(aes(col = percentile50))  + xlab ("Percentile of polygenic scores") + ylab ("Mean self-harm score") + theme_classic()+ guides(colour = FALSE) + ggtitle ("Self-harm score")

selfharmideationplot = ggplot(na.omit(selfharmideationaverage), aes(x=percentile50, y=mean)) + geom_point(aes(col = percentile50))  + xlab ("Percentile of polygenic scores") + ylab ("Mean self-harm ideation score") + theme_classic() + guides(colour = FALSE) + ggtitle("Self-harm ideation score")

multiplot(childtraumaplot, selfharmscoreplot, selfharmideationplot, cols = 3)
```


\newpage

## Plots based on percentile for each individual item
```{R create plots for individual items}

lifenotlivingplot = ggplot(na.omit(lifenotworthlivingaverage), aes(x=percentile50, y=mean)) + geom_point(aes(col = percentile50))  + xlab ("Percentile of polygenic scores") + ylab ("Mean life not worth living score") + theme_classic()+ guides(colour = FALSE) + ggtitle("Life not worth living")

contemplateselfharmplot = ggplot(na.omit(contemplateselfharmaverage), aes(x=percentile50, y=mean)) + geom_point(aes(col = percentile50))  + xlab ("Percentile of polygenic scores") + ylab ("Mean contemplate self-harm score") + theme_classic()+ guides(colour = FALSE) + ggtitle ("Contemplate self-harm")

attemptselfharmplot = ggplot(na.omit(attemptselfharmaverage), aes(x=percentile50, y=mean)) + geom_point(aes(col = percentile50))  + xlab ("Percentile of polygenic scores") + ylab ("Mean attempt self-harm score") + theme_classic() + guides(colour = FALSE) + ggtitle("Attempt self-harm")

multiplot(lifenotlivingplot, contemplateselfharmplot, attemptselfharmplot, cols = 3)

cat("\n")

felthatedplot = ggplot(na.omit(felthatedaverage), aes(x=percentile25, y=mean)) + geom_point(aes(col = percentile25))  + xlab ("Percentile of polygenic scores") + ylab ("Mean felt hated score") + theme_classic()+ guides(colour = FALSE) + ggtitle("Felt hated")

feltlovedplot = ggplot(na.omit(feltlovedaverage), aes(x=percentile25, y=mean)) + geom_point(aes(col = percentile25))  + xlab ("Percentile of polygenic scores") + ylab ("Mean felt loved (inv.) score") + theme_classic()+ guides(colour = FALSE) + ggtitle ("Felt loved (inv.)")

physicalabuseplot = ggplot(na.omit(physicalabuseaverage), aes(x=percentile25, y=mean)) + geom_point(aes(col = percentile25))  + xlab ("Percentile of polygenic scores") + ylab ("Mean physical abuse score") + theme_classic() + guides(colour = FALSE) + ggtitle("Physical abuse")

multiplot(felthatedplot, feltlovedplot, physicalabuseplot, cols = 3)


```


